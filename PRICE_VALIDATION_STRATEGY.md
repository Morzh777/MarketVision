# Стратегия валидации цен (анти-скам)

## Цель
Отсекать фейковые/поддельные товары не по названию, а по цене, используя базовую минимальную цену и её контролируемое авто‑обновление.

## Базовый принцип
- При добавлении модели (category + модель/запрос) задаётся базовая минимальная цена `minPrice`.
- На валидации отбрасываем товары со слишком низкой ценой:
  - Если `price < minPrice × 0.7` (ниже на 30%) → товар считается скамом и отклоняется.

## Авто‑обновление minPrice
Чтобы `minPrice` не устаревала:
- Периодичность: раз в 1–4 недели (настроечно).
- Источник: метрики рынка (marketStats) по валидным товарам за период.
- Кандидат на новую базу: медиана (или 10‑й перцентиль) цен валидных товаров.
- Условия пересмотра:
  - Достаточно наблюдений (например, ≥ 10 валидных товаров за период).
  - Изменение устойчивое: |newMedian − minPrice| / minPrice > 15%.
  - Тогда `minPrice := newMedian` и фиксируется `lastUpdated`.

## Ручная корректировка
- В любой момент допускается ручное обновление `minPrice` (через админку/API), с указанием причины.

## Поведение при отсутствии статистики
- Если marketStats временно недоступны или мало наблюдений — используем текущую `minPrice` без авто‑обновления.

## Резюме проверки на валидации
- Для каждой модели на входе:
  1) Берём актуальную `minPrice`.
  2) Отсекаем все `price < minPrice × 0.7`.
  3) Остальное проходит к дальнейшей логике (группировка/отбор).

## Мониторинг (опционально)
- Алерты при резком падении медианы (> 25% за период) для ручной проверки.
- Логирование всех авто‑пересмотров `minPrice` (кто/когда/на сколько).
