# üñºÔ∏è –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π MarketVision

## üìã –ß—Ç–æ –∫–µ—à–∏—Ä—É–µ—Ç—Å—è

### 1. **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤**
- **–í—Ä–µ–º—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è:** 1 –≥–æ–¥ (immutable)
- **–§–æ—Ä–º–∞—Ç—ã:** JPG, PNG, GIF, WebP, AVIF
- **–ò—Å—Ç–æ—á–Ω–∏–∫–∏:** WB, Ozon CDN

### 2. **–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã**
- **CSS/JS:** 1 –≥–æ–¥
- **–®—Ä–∏—Ñ—Ç—ã:** 1 –≥–æ–¥
- **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:** 1 –≥–æ–¥

### 3. **API –¥–∞–Ω–Ω—ã–µ**
- **–ü—Ä–æ–¥—É–∫—Ç—ã:** 10 –º–∏–Ω—É—Ç
- **–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã:** 10 –º–∏–Ω—É—Ç
- **–ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω:** 10 –º–∏–Ω—É—Ç

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Next.js

### `next.config.ts`
```typescript
images: {
  // –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
  minimumCacheTTL: 600, // 10 –º–∏–Ω—É—Ç
  
  // –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–æ–≤
  formats: ['image/webp', 'image/avif'],
  
  // –†–∞–∑–º–µ—Ä—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
  deviceSizes: [640, 750, 828, 1080, 1200, 1920, 2048, 3840],
  imageSizes: [16, 32, 48, 64, 96, 128, 256, 384],
}
```

### –ó–∞–≥–æ–ª–æ–≤–∫–∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
```typescript
async headers() {
  return [
    {
      source: '/images/:path*',
      headers: [
        {
          key: 'Cache-Control',
          value: 'public, max-age=31536000, immutable', // 1 –≥–æ–¥
        },
      ],
    },
  ];
}
```

## üîß –ö–æ–º–ø–æ–Ω–µ–Ω—Ç OptimizedImage

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
```typescript
import OptimizedImage from '@/components/OptimizedImage';

<OptimizedImage
  src="https://cdn1.ozone.ru/product-image.jpg"
  alt="RTX 5070"
  width={300}
  height={200}
  priority={true} // –¥–ª—è LCP –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
/>
```

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
- **Lazy loading** –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∏–∂–µ fold
- **Priority loading** –¥–ª—è LCP –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **Fallback** –ø—Ä–∏ –æ—à–∏–±–∫–µ –∑–∞–≥—Ä—É–∑–∫–∏
- **WebP/AVIF** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è
- **Blur placeholder** –≤–æ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏

## üìä Middleware –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ

### `src/middleware.ts`
```typescript
// –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
if (request.nextUrl.pathname.match(/\.(jpg|jpeg|png|gif|webp|avif)$/)) {
  response.headers.set('Cache-Control', 'public, max-age=31536000, immutable')
}
```

## üöÄ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **–ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞** - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ –∫–µ—à–∞
2. **–ú–µ–Ω—å—à–µ —Ç—Ä–∞—Ñ–∏–∫–∞** - –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–æ
3. **–õ—É—á—à–∏–π UX** - –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
4. **SEO –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** - –±—ã—Å—Ç—Ä—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

## üö® –í–∞–∂–Ω–æ

- **Immutable –∫–µ—à** - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ –º–µ–Ω—è—é—Ç—Å—è
- **1 –≥–æ–¥ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è** - –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ
- **WebP/AVIF** - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã
- **Lazy loading** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

–î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:
1. –ò–∑–º–µ–Ω–∏—Ç—å URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
2. –î–æ–±–∞–≤–∏—Ç—å –≤–µ—Ä—Å–∏—é –≤ URL: `image.jpg?v=2`
3. –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —Å–±—Ä–æ—Å–∏—Ç—å –∫–µ—à

## üì± –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö

- **Responsive images** - —Ä–∞–∑–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –¥–ª—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- **WebP fallback** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
- **Lazy loading** - –∑–∞–≥—Ä—É–∑–∫–∞ –ø–æ –º–µ—Ä–µ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏
