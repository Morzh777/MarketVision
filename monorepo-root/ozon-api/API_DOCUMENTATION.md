# Ozon API Documentation

## –û–±–∑–æ—Ä

Ozon API - —ç—Ç–æ gRPC —Å–µ—Ä–≤–∏—Å –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ —Ç–æ–≤–∞—Ä–æ–≤ —Å Ozon.ru. –°–µ—Ä–≤–∏—Å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è Product-Filter-Service.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
Product-Filter-Service ‚Üí Ozon API (gRPC) ‚Üí Ozon Parser ‚Üí Ozon.ru
```

**–ü–æ—Ä—Ç:** 3002  
**–ü—Ä–æ—Ç–æ–∫–æ–ª:** gRPC  
**Proto —Ñ–∞–π–ª:** `raw-product.proto`

## gRPC API Reference

### RawProductService

#### GetRawProducts

–ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ —Å Ozon.ru –ø–æ –ø–æ–∏—Å–∫–æ–≤–æ–º—É –∑–∞–ø—Ä–æ—Å—É.

**–ú–µ—Ç–æ–¥:** `GetRawProducts`

**Request:**
```proto
message GetRawProductsRequest {
  string query = 1;        // –ü–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
  string category = 2;     // –°–ª–∞–≥ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
  string platform_id = 3;  // ID –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
}
```

**Response:**
```proto
message GetRawProductsResponse {
  repeated RawProduct products = 1;  // –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤
  int32 total_count = 2;             // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤
  string source = 3;                 // –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö ("ozon")
}
```

**RawProduct:**
```proto
message RawProduct {
  string id = 1;           // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID —Ç–æ–≤–∞—Ä–∞
  string name = 2;         // –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
  int32 price = 3;         // –¶–µ–Ω–∞ –≤ —Ä—É–±–ª—è—Ö (—Ü–µ–ª–æ–µ —á–∏—Å–ª–æ)
  string image_url = 4;    // URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
  string product_url = 5;  // URL —Ç–æ–≤–∞—Ä–∞ –Ω–∞ Ozon
  string category = 6;     // –ö–∞—Ç–µ–≥–æ—Ä–∏—è —Ç–æ–≤–∞—Ä–∞
  string source = 7;       // –ò—Å—Ç–æ—á–Ω–∏–∫ ("ozon")
  string query = 8;        // –ü–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
}
```


## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### gRPC Status Codes

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ | –ö–æ–≥–¥–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç |
|-----|----------|-----------------|
| `OK` | –£—Å–ø–µ—à–Ω–æ | –ó–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ |
| `INVALID_ARGUMENT` | –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã | –ü—É—Å—Ç–æ–π query –∏–ª–∏ category |
| `UNAVAILABLE` | –°–µ—Ä–≤–∏—Å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω | –ü–∞—Ä—Å–µ—Ä –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç |
| `INTERNAL` | –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ | –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ |
| `DEADLINE_EXCEEDED` | –ü—Ä–µ–≤—ã—à–µ–Ω —Ç–∞–π–º–∞—É—Ç | –î–æ–ª–≥–∏–π –æ—Ç–≤–µ—Ç –æ—Ç Ozon |

### –ü—Ä–∏–º–µ—Ä—ã –æ—à–∏–±–æ–∫

```
INVALID_ARGUMENT: "Query cannot be empty"
INVALID_ARGUMENT: "Category cannot be empty"
UNAVAILABLE: "Parser service is currently unavailable"
INTERNAL: "Internal parser error: Network timeout"
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### Python gRPC Client

```python
import grpc
import raw_product_pb2
import raw_product_pb2_grpc

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–∏—Å—É
channel = grpc.insecure_channel('localhost:3002')
stub = raw_product_pb2_grpc.RawProductServiceStub(channel)

# –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞
request = raw_product_pb2.GetRawProductsRequest(
    query="RTX 4090",
    category="videokarty-15721"
)

# –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞
try:
    response = stub.GetRawProducts(request)
    print(f"–ù–∞–π–¥–µ–Ω–æ {response.total_count} —Ç–æ–≤–∞—Ä–æ–≤:")
    for product in response.products:
        print(f"- {product.name}: {product.price} —Ä—É–±.")
except grpc.RpcError as e:
    print(f"–û—à–∏–±–∫–∞: {e.code()} - {e.details()}")
```

### –° –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–π

```python
request = raw_product_pb2.GetRawProductsRequest(
    query="PlayStation 5",
    category="igrovye-pristavki-15625",
    platform_id="playstation-5"
)
```

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **–°—Ä–µ–¥–Ω—è—è —Å–∫–æ—Ä–æ—Å—Ç—å –ø–∞—Ä—Å–∏–Ω–≥–∞:** 2-5 —Å–µ–∫—É–Ω–¥ –Ω–∞ –∑–∞–ø—Ä–æ—Å
- **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤:** 60 –∑–∞ –∑–∞–ø—Ä–æ—Å
- **–¢–∞–π–º–∞—É—Ç:** 30 —Å–µ–∫—É–Ω–¥
- **–†–µ—Ç—Ä–∞–∏:** 3 –ø–æ–ø—ã—Ç–∫–∏ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –õ–æ–≥–∏

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å –ø—Ä–µ—Ñ–∏–∫—Å–∞–º–∏:
- `üîç` - –ù–∞—á–∞–ª–æ –ø–∞—Ä—Å–∏–Ω–≥–∞
- `‚úÖ` - –£—Å–ø–µ—à–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ
- `‚ùå` - –û—à–∏–±–∫–∞
- `‚ö†Ô∏è` - –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
- `üéÆ` - –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

### –ú–µ—Ç—Ä–∏–∫–∏

- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
- –°—Ä–µ–¥–Ω—è—è —Å–∫–æ—Ä–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫
- –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø–∞—Ä—Å–µ—Ä–∞

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞

```bash
cd monorepo-root/ozon-api
python -m pip install -r requirements.txt
python src/main.py
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# Unit —Ç–µ—Å—Ç—ã
pytest src/tests/

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤
mypy src/

# –õ–∏–Ω—Ç–∏–Ω–≥
flake8 src/
```

### –¢–µ—Å—Ç–æ–≤—ã–π gRPC –∫–ª–∏–µ–Ω—Ç

```bash
python test_grpc_client.py
```

## –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º

–°–µ—Ä–≤–∏—Å —Å–ª–µ–¥—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É `PARSER-DATA-STANDARD.md`:

‚úÖ **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:**
- `id` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Å—Ç—Ä–æ–∫–æ–≤—ã–π ID
- `name` - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞  
- `price` - —Ü–µ–Ω–∞ –≤ —Ä—É–±–ª—è—Ö (—á–∏—Å–ª–æ)
- `query` - –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å

‚úÖ **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:**
- `image_url` - URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- `product_url` - URL —Ç–æ–≤–∞—Ä–∞
- `category` - –∫–∞—Ç–µ–≥–æ—Ä–∏—è
- `source` - –≤—Å–µ–≥–¥–∞ "ozon"

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **–¢–æ–ª—å–∫–æ –ø–∞—Ä—Å–∏–Ω–≥** - –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
2. **–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** - –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –∑–∞ —Ä–∞–∑
3. **Selenium –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å** - —Ç—Ä–µ–±—É–µ—Ç ChromeDriver
4. **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ Ozon** - –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –ø—Ä–∏ —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö

## –ö–æ–Ω—Ç–∞–∫—Ç—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏

- **–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** `monorepo-root/ozon-api/`
- **–õ–æ–≥–∏:** –ö–æ–Ω—Å–æ–ª—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** `src/main.py` 