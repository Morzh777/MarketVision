# WB-API Microservice

–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –Ω–∞ –±–∞–∑–µ [NestJS](https://nestjs.com/) –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –∏ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –æ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã—Ö –∫–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏—Ö (–≤–∏–¥–µ–æ–∫–∞—Ä—Ç—ã, –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã –∏ –¥—Ä.) —Å Wildberries. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ —á–∞—Å—Ç—å –º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–æ—Ç–æ —á–µ—Ä–µ–∑ Redis, –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è –ø–æ–¥ –Ω–æ–≤—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.

## –û–ø–∏—Å–∞–Ω–∏–µ

–°–µ—Ä–≤–∏—Å —Ä–µ–∞–ª–∏–∑—É–µ—Ç –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã—Ö –∫–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏—Ö —Å Wildberries. –î–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—ã, –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã) —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å.

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- **–ü–æ–∏—Å–∫ —Å–∞–º–æ–π –¥–µ—à—ë–≤–æ–π –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—ã –∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞** –ø–æ –∫–∞–∂–¥–æ–º—É –∑–∞–ø—Ä–æ—Å—É –∏–∑ –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞.
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤** –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º –∏ —à–∞–±–ª–æ–Ω–∞–º.
- **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π**: –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —Ñ–æ—Ç–æ —Ç–æ–≤–∞—Ä–æ–≤ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ Redis –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.
- **–£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–µ–π**: –≤ –∏—Ç–æ–≥–æ–≤–æ–º —Å–ø–∏—Å–∫–µ —Ç–æ–ª—å–∫–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –ø–æ id (–¥–∞–∂–µ –µ—Å–ª–∏ –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ —Ç–æ–≤–∞—Ä –ø–æ–ø–∞–ª –ø–æ —Ä–∞–∑–Ω—ã–º –∑–∞–ø—Ä–æ—Å–∞–º).
- **–ì–∏–±–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É –ø–æ–∏—Å–∫–∞.

#### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–µ—à —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
- –ö–µ—à —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ Redis —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –ø—Ä–µ—Ñ–∏–∫—Å–æ–º –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.
- –ü—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–∏—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —ç—Ç–æ—Ç –∫–µ—à –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –ø–æ–∏—Å–∫–∞ —Ñ–æ—Ç–æ.
- –ï—Å–ª–∏ —Ñ–æ—Ç–æ –¥–ª—è —Ç–æ–≤–∞—Ä–∞ –Ω–∞–π–¥–µ–Ω–æ –≤–ø–µ—Ä–≤—ã–µ, –æ–Ω–æ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –∫–µ—à. –ï—Å–ª–∏ —Ñ–æ—Ç–æ —É—Å—Ç–∞—Ä–µ–ª–æ –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ ‚Äî —Å–µ—Ä–≤–∏—Å –∏—â–µ—Ç –Ω–æ–≤–æ–µ –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –∫–µ—à.

#### –õ–æ–≥–∏–∫–∞ –ø–æ–∏—Å–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–∏—Å–∫–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ —Å–µ—Ä–≤–∏—Å –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ Wildberries API.
- –ò–∑ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è **—Å–∞–º—ã–π –¥–µ—à—ë–≤—ã–π** —Ç–æ–≤–∞—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ—Ö–æ–¥–∏—Ç —Ñ–∏–ª—å—Ç—Ä –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é.
- –ï—Å–ª–∏ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤ –Ω–µ—Ç ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ —ç—Ç–æ–º—É –∑–∞–ø—Ä–æ—Å—É –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è.
- –ü–æ—Å–ª–µ —Å–±–æ—Ä–∞ –≤—Å–µ—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å–µ—Ä–≤–∏—Å –æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –ø–æ `product.id`.

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ü–æ–∏—Å–∫ –ø–æ —Å–ø–∏—Å–∫—É –∑–∞–ø—Ä–æ—Å–æ–≤**: –°–µ—Ä–≤–∏—Å –∏—â–µ—Ç —Å–∞–º—ã–µ –¥–µ—à—ë–≤—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º—É —Å–ø–∏—Å–∫—É –º–æ–¥–µ–ª–µ–π.
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è**: –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø–æ–º–æ–≥–∞–µ—Ç –æ—Ç—Å–µ–∏–≤–∞—Ç—å –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∞–∫—Å–µ—Å—Å—É–∞—Ä—ã, –∫–∞–±–µ–ª–∏, –Ω–æ—É—Ç–±—É–∫–∏).
- **–ü–æ–∏—Å–∫ –∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π**: –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –º–µ—Ö–∞–Ω–∏–∑–º –ø–æ–∏—Å–∫–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π —Ç–æ–≤–∞—Ä–æ–≤, –≤–∫–ª—é—á–∞—è –∏—Ö –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤. –ö–µ—à —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ Redis.
- **–£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–µ–π**: –í –∏—Ç–æ–≥–æ–≤–æ–º —Å–ø–∏—Å–∫–µ —Ç–æ–ª—å–∫–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –ø–æ id.
- **–ú–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞**: –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –ø–∞—Ä—Å–µ—Ä—ã –¥–ª—è –Ω–æ–≤—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ç–æ–≤–∞—Ä–æ–≤, –Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—è —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –ª–æ–≥–∏–∫—É.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Node.js >= 18
- npm
- Redis (–ª–æ–∫–∞–ª—å–Ω–æ –∏–ª–∏ –≤ Docker/WSL)

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

-   [NestJS](https://nestjs.com/) - –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π Node.js —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã—Ö —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.
-   [TypeScript](https://www.typescriptlang.org/) - –¥–ª—è —Å—Ç—Ä–æ–≥–æ–π —Ç–∏–ø–∏–∑–∞—Ü–∏–∏ –∏ —É–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞.
-   [Axios](https://axios-http.com/) - –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API Wildberries.

---

## ‚öôÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã WB API

### WB xsubject –∑–Ω–∞—á–µ–Ω–∏—è (–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤)

**–ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è xsubject –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ Wildberries API:**

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | xsubject | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|----------|----------|
| **–í–∏–¥–µ–æ–∫–∞—Ä—Ç—ã** | `3274` | –í–∏–¥–µ–æ–∫–∞—Ä—Ç—ã –∏ GPU –¥–ª—è –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤ |
| **–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã** | `3698` | CPU –∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã –¥–ª—è –ü–ö |
| **–ú–∞—Ç–µ—Ä–∏–Ω—Å–∫–∏–µ –ø–ª–∞—Ç—ã** | `3690` | –ú–∞—Ç–µ—Ä–∏–Ω—Å–∫–∏–µ –ø–ª–∞—Ç—ã –∏ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø–ª–∞—Ç—ã |

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ

```typescript
// –í–∏–¥–µ–æ–∫–∞—Ä—Ç—ã
protected readonly xsubject = 3274;

// –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã
protected readonly xsubject = 3698;

// –ú–∞—Ç–µ—Ä–∏–Ω—Å–∫–∏–µ –ø–ª–∞—Ç—ã
protected readonly xsubject = 3690;
```

### –ü—Ä–∏–º–µ—Ä—ã API –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ WB

```
https://search.wb.ru/exactmatch/ru/common/v4/search?appType=1&couponsGeo=12,3,18,15,21&curr=rub&dest=-1257786&query=rtx4070&resultset=catalog&sort=priceup&spp=30&suppressSpellcheck=false&xsubject=3274

https://search.wb.ru/exactmatch/ru/common/v4/search?appType=1&couponsGeo=12,3,18,15,21&curr=rub&dest=-1257786&query=ryzen7&resultset=catalog&sort=priceup&spp=30&suppressSpellcheck=false&xsubject=3698
```

**‚ö†Ô∏è –í–∞–∂–Ω–æ:** –≠—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã –¥–ª—è Wildberries API –∏ –º–æ–≥—É—Ç –∏–∑–º–µ–Ω—è—Ç—å—Å—è. –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–∞ WB –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±–Ω–æ–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å–µ—Ä–≤–∏—Å–∞—Ö.

---

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ Redis**

   - **–ß–µ—Ä–µ–∑ Docker** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):
     ```sh
     docker run --name redis -p 6379:6379 redis
     ```
   - **–ß–µ—Ä–µ–∑ WSL**:
     ```sh
     sudo apt update
     sudo apt install redis-server
     redis-server
     ```
   - **–ü–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è Windows**:  
     [–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è](https://github.com/tporadowski/redis/releases)

2. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å–µ—Ä–≤–∏—Å–∞:**
   ```sh
   cd monorepo-root/wb-api
   ```

3. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
   ```sh
   npm install
   ```

4. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**
   ```sh
   npm run start:dev
   ```
   –°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É [http://localhost:3000](http://localhost:3000).

5. **–ó–∞–ø—É—Å–∫ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω-—Ä–µ–∂–∏–º–µ:**
   ```sh
   npm run build
   npm run start:prod
   ```

---

## API Endpoints

### –í–∏–¥–µ–æ–∫–∞—Ä—Ç—ã

- `GET /parser/videocards`  
  –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å–∞–º—ã—Ö –¥–µ—à—ë–≤—ã—Ö –≤–∏–¥–µ–æ–∫–∞—Ä—Ç –ø–æ –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º –∑–∞–ø—Ä–æ—Å–∞–º.

### –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã

- `GET /parser/cpus`  
  –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å–∞–º—ã—Ö –¥–µ—à—ë–≤—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤ –ø–æ –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º –∑–∞–ø—Ä–æ—Å–∞–º.

### –ú–∞—Ç–µ—Ä–∏–Ω—Å–∫–∏–µ –ø–ª–∞—Ç—ã

- `GET /parser/motherboards`  
  –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å–∞–º—ã—Ö –¥–µ—à—ë–≤—ã—Ö –º–∞—Ç–µ—Ä–∏–Ω—Å–∫–∏—Ö –ø–ª–∞—Ç –ø–æ –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º –∑–∞–ø—Ä–æ—Å–∞–º.

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –∫ –ø–∞—Ä—Å–∏–Ω–≥—É

–î–ª—è —É–¥–æ–±–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API:

### üì± –ü—Ä—è–º—ã–µ —Å—Å—ã–ª–∫–∏ (–æ—Ç–∫—Ä–æ—é—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ):
- **–í–∏–¥–µ–æ–∫–∞—Ä—Ç—ã**: [http://localhost:3000/parser/videocards](http://localhost:3000/parser/videocards)
- **–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã**: [http://localhost:3000/parser/cpus](http://localhost:3000/parser/cpus)
- **–ú–∞—Ç–µ—Ä–∏–Ω—Å–∫–∏–µ –ø–ª–∞—Ç—ã**: [http://localhost:3000/parser/motherboards](http://localhost:3000/parser/motherboards)

### üíª –ß–µ—Ä–µ–∑ curl:
```bash
# –ü–∞—Ä—Å–∏–Ω–≥ –≤–∏–¥–µ–æ–∫–∞—Ä—Ç
curl http://localhost:3000/parser/videocards

# –ü–∞—Ä—Å–∏–Ω–≥ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤  
curl http://localhost:3000/parser/cpus

# –ü–∞—Ä—Å–∏–Ω–≥ –º–∞—Ç–µ—Ä–∏–Ω—Å–∫–∏—Ö –ø–ª–∞—Ç
curl http://localhost:3000/parser/motherboards
```

### üîß –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
```bash
# –° –∫—Ä–∞—Å–∏–≤—ã–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º JSON
curl -s http://localhost:3000/parser/cpus | jq '.'

# –¢–æ–ª—å–∫–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
curl -s http://localhost:3000/parser/cpus | jq '.stats'

# –¢–æ–ª—å–∫–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
curl -s http://localhost:3000/parser/cpus | jq '.results[]'
```

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞ API

API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç —Å –¥–≤—É–º—è –∫–ª—é—á–∞–º–∏: `results` (–º–∞—Å—Å–∏–≤ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤) –∏ `stats` (—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞).

### –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```json
{
  "results": [
    // ... –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ SearchResult
  ],
  "stats": {
    // ... –æ–±—ä–µ–∫—Ç Stats
  }
}
```

---

### –û–±—ä–µ–∫—Ç `SearchResult` (–≠–ª–µ–º–µ–Ω—Ç –º–∞—Å—Å–∏–≤–∞ `results`)

–ö–∞–∂–¥—ã–π –æ–±—ä–µ–∫—Ç –≤ –º–∞—Å—Å–∏–≤–µ `results` –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –æ–¥–∏–Ω —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ç–æ–≤–∞—Ä, –Ω–∞–π–¥–µ–Ω–Ω—ã–π –ø–æ –æ–¥–Ω–æ–º—É –∏–∑ –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.

```json
{
  "query": "rtx 4070 super",
  "product": {
    "id": 218737525,
    "name": "–í–∏–¥–µ–æ–∫–∞—Ä—Ç–∞ –∏–≥—Ä–æ–≤–∞—è NVIDIA GeForce RTX 4070 SUPER",
    "brand": "KFA2",
    "price": 67924,
    "sizes": [
        // ... —Å–ª—É–∂–µ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è WB
    ]
  },
  "stableId": "kfa2rtx4070supergaming",
  "photoFound": true,
  "photoUrl": "https://basket-21.wbbasket.ru/vol2187/part218737/218737525/images/big/1.webp",
  "previousPrice": 71000,
  "discount": 4
}
```

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
| :--- | :--- | :--- |
| `query` | `string` | –ü–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –±—ã–ª –Ω–∞–π–¥–µ–Ω —Ç–æ–≤–∞—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, "rtx 4070 super"). |
| `product` | `object` | –û–±—ä–µ–∫—Ç —Å –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Ç–æ–≤–∞—Ä–µ –æ—Ç Wildberries. |
| `product.id` | `number` | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π —á–∏—Å–ª–æ–≤–æ–π ID —Ç–æ–≤–∞—Ä–∞ –Ω–∞ Wildberries. **–ú–æ–∂–µ—Ç –º–µ–Ω—è—Ç—å—Å—è.** |
| `product.name` | `string` | –ü–æ–ª–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞. |
| `product.brand`| `string` | –ë—Ä–µ–Ω–¥ —Ç–æ–≤–∞—Ä–∞. |
| `stableId` | `string` | **–°—Ç–∞–±–∏–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä**, —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ–≥–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Ü–µ–Ω—ã –∏ –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ—Å—Ç–æ–≤, –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç `product.id`. |
| `photoFound` | `boolean` | `true`, –µ—Å–ª–∏ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—á—É—é —Å—Å—ã–ª–∫—É –Ω–∞ —Ñ–æ—Ç–æ —Ç–æ–≤–∞—Ä–∞. |
| `photoUrl` | `string` | –ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ `.webp`. |
| `previousPrice`| `number` | –ü—Ä–µ–¥—ã–¥—É—â–∞—è "–ª—É—á—à–∞—è" —Ü–µ–Ω–∞ –Ω–∞ —ç—Ç–æ—Ç —Ç–æ–≤–∞—Ä, –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤ Redis. |
| `discount` | `number` | –†–∞—Å—Å—á–∏—Ç–∞–Ω–Ω–∞—è —Å–∫–∏–¥–∫–∞ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö, –µ—Å–ª–∏ —Ç–µ–∫—É—â–∞—è —Ü–µ–Ω–∞ –Ω–∏–∂–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–π. |

---

### –û–±—ä–µ–∫—Ç `Stats`

–û–±—ä–µ–∫—Ç `stats` —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–≤–æ–¥–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ—Ü–µ—Å—Å–µ –ø–∞—Ä—Å–∏–Ω–≥–∞.

```json
{
  "executionTime": 25.4,
  "totalProducts": 21,
  "foundPhotos": 21,
  "errorCount": 2,
  "photoSuccessRate": 1,
  "avgSpeed": 0.85
}
```

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
| :--- | :--- | :--- |
| `executionTime` | `number` | –û–±—â–µ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö. |
| `totalProducts` | `number` | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ **—É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö** —Ç–æ–≤–∞—Ä–æ–≤, –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –ø–æ –≤—Å–µ–º –∑–∞–ø—Ä–æ—Å–∞–º. |
| `foundPhotos` | `number` | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ —Ñ–æ—Ç–æ. |
| `errorCount` | `number` | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–≤–µ—Ä—à–∏–ª–∏—Å—å —Å –æ—à–∏–±–∫–æ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑-–∑–∞ —Ç–∞–π–º–∞—É—Ç–∞). |
| `photoSuccessRate`|`number`| –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π (–æ—Ç 0 –¥–æ 1). |
| `avgSpeed` | `number` | –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –æ–¥–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö. |


---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ —Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å

- –í—Å—è –æ–±—â–∞—è –ª–æ–≥–∏–∫–∞ –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π –∫–ª–∞—Å—Å `BaseParserService` (–æ—á–µ—Ä–µ–¥–∏, –∫–µ—à, –ø–æ–∏—Å–∫, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, —Ä–∞–±–æ—Ç–∞ —Å —Ñ–æ—Ç–æ, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ).
- –°–µ—Ä–≤–∏—Å—ã –≤–∏–¥–µ–æ–∫–∞—Ä—Ç –∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤ –Ω–∞—Å–ª–µ–¥—É—é—Ç —ç—Ç–æ—Ç –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –∏ —Ä–µ–∞–ª–∏–∑—É—é—Ç —Ç–æ–ª—å–∫–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (—Å–ø–∏—Å–æ–∫ –∑–∞–ø—Ä–æ—Å–æ–≤, subjectId, —Ñ–∏–ª—å—Ç—Ä).
- –ö–µ—à —Ñ–æ—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —á–µ—Ä–µ–∑ Redis —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –ø—Ä–µ—Ñ–∏–∫—Å–æ–º –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.
- –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: —Å–æ–∑–¥–∞–π—Ç–µ —Å–µ—Ä–≤–∏—Å, —É–∫–∞–∂–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ —Ä–µ–∞–ª–∏–∑—É–π—Ç–µ —Ñ–∏–ª—å—Ç—Ä.

---

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Redis

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Redis

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `test-redis.js` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```javascript
import { createClient } from 'redis';

const client = createClient({ 
  url: process.env.REDIS_URL || 'redis://localhost:6379' 
});

async function testRedis() {
  try {
    await client.connect();
    console.log('‚úÖ Redis –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ!');
    
    // –¢–µ—Å—Ç –∑–∞–ø–∏—Å–∏ –∏ —á—Ç–µ–Ω–∏—è
    await client.set('test', 'hello');
    const value = await client.get('test');
    console.log(`üìù –¢–µ—Å—Ç –∑–∞–ø–∏—Å–∏/—á—Ç–µ–Ω–∏—è: ${value}`);
    
    // –û—á–∏—â–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π –∫–ª—é—á
    await client.del('test');
    console.log('üßπ –¢–µ—Å—Ç–æ–≤—ã–π –∫–ª—é—á —É–¥–∞–ª–µ–Ω');
    
  } catch (error) {
    console.error('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Redis:', error.message);
  } finally {
    await client.disconnect();
  }
}

testRedis();
```

–ó–∞–ø—É—Å–∫:
```bash
node test-redis.js
```

### –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –∫—ç—à–µ–π Redis

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `clear-redis.js` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```javascript
import { createClient } from 'redis';

const client = createClient({ 
  url: process.env.REDIS_URL || 'redis://localhost:6379' 
});

async function clearRedis() {
  try {
    await client.connect();
    console.log('üîó –ü–æ–¥–∫–ª—é—á–∏–ª—Å—è –∫ Redis');

    // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –∫–ª—é—á–∏
    const allKeys = await client.keys('*');
    console.log(`üìä –ù–∞–π–¥–µ–Ω–æ –∫–ª—é—á–µ–π: ${allKeys.length}`);

    if (allKeys.length === 0) {
      console.log('‚úÖ Redis —É–∂–µ –ø—É—Å—Ç');
      return;
    }

    // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –∫–ª—é—á–∏ –ø–æ —Ç–∏–ø–∞–º
    const photoKeys = allKeys.filter(key => key.includes(':'));
    const priceKeys = allKeys.filter(key => key.startsWith('last_posted_price:'));
    const historyKeys = allKeys.filter(key => key.startsWith('price_history:'));
    const postedKeys = allKeys.filter(key => key.startsWith('posted:'));

    console.log(`üì∏ –§–æ—Ç–æ-–∫—ç—à: ${photoKeys.length} –∫–ª—é—á–µ–π`);
    console.log(`üí∞ –ö—ç—à —Ü–µ–Ω: ${priceKeys.length} –∫–ª—é—á–µ–π`);
    console.log(`üìà –ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω: ${historyKeys.length} –∫–ª—é—á–µ–π`);
    console.log(`üìù –ò—Å—Ç–æ—Ä–∏—è –ø–æ—Å—Ç–æ–≤: ${postedKeys.length} –∫–ª—é—á–µ–π`);

    // –£–¥–∞–ª—è–µ–º –≤—Å–µ –∫–ª—é—á–∏
    if (allKeys.length > 0) {
      await client.del(allKeys);
      console.log('üóëÔ∏è –í—Å–µ –∫–ª—é—á–∏ —É–¥–∞–ª–µ–Ω—ã');
    }

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å—ë —É–¥–∞–ª–µ–Ω–æ
    const remainingKeys = await client.keys('*');
    console.log(`‚úÖ –û—Å—Ç–∞–ª–æ—Å—å –∫–ª—é—á–µ–π: ${remainingKeys.length}`);

  } catch (error) {
    console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ Redis:', error);
  } finally {
    await client.disconnect();
    console.log('üîå –û—Ç–∫–ª—é—á–∏–ª—Å—è –æ—Ç Redis');
  }
}

clearRedis();
```

–ó–∞–ø—É—Å–∫:
```bash
node clear-redis.js
```

### –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –æ—á–∏—â–∞—Ç—å –∫—ç—à

- **–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏** (—á—Ç–æ–±—ã —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –≤–ª–∏—è–ª–∏ –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç)
- **–ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö** –≤ –∫—ç—à–µ
- **–ü—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π**
- **–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏** –≤ –∫—ç—à–µ

### –¢–∏–ø—ã –∫—ç—à–µ–π –≤ Redis

1. **–§–æ—Ç–æ-–∫—ç—à** (`prefix:product_id`) - URL —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π —Ç–æ–≤–∞—Ä–æ–≤
2. **–ö—ç—à —Ü–µ–Ω** (`last_posted_price:category:stable_id`) - –ø–æ—Å–ª–µ–¥–Ω–∏–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ —Ü–µ–Ω—ã
3. **–ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω** (`price_history:category:stable_id`) - –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω
4. **–ò—Å—Ç–æ—Ä–∏—è –ø–æ—Å—Ç–æ–≤** (`posted:category:stable_id`) - –æ—Ç–º–µ—Ç–∫–∏ –æ–± –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–∞—Ö

---

## –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏

- **ECONNREFUSED –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ** ‚Äî Redis –Ω–µ –∑–∞–ø—É—â–µ–Ω –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Redis —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ `localhost:6379`.
- **–ü—Ä–æ–±–ª–µ–º—ã —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏** ‚Äî —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã–ø–æ–ª–Ω–∏–ª–∏ `npm install` –≤ –ø–∞–ø–∫–µ —Å–µ—Ä–≤–∏—Å–∞.

---

## –¢–µ—Å—Ç—ã

```bash
# unit tests
$ npm run test

# e2e tests
$ npm run test:e2e

# test coverage
$ npm run test:cov
```

---

## License

Nest is [MIT licensed](https://github.com/nestjs/nest/blob/master/LICENSE).

## –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ –ø–∞—Ä—Å–∏–Ω–≥–∞ –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞

- [–ü–∞—Ä—Å–∏–Ω–≥ –≤–∏–¥–µ–æ–∫–∞—Ä—Ç](http://localhost:3000/parser/videocards)
- [–ü–∞—Ä—Å–∏–Ω–≥ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤](http://localhost:3000/parser/cpus)
- [–ü–∞—Ä—Å–∏–Ω–≥ –º–∞—Ç–µ—Ä–∏–Ω—Å–∫–∏—Ö –ø–ª–∞—Ç](http://localhost:3000/parser/motherboards)
