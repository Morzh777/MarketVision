# ü§ñ Telegram Bot –¥–ª—è WBInfo

Telegram-–±–æ—Ç –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ü–µ–Ω –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ –∫–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏–µ –∏ –∏–≥—Ä–æ–≤—ã–µ –∫–æ–Ω—Å–æ–ª–∏ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π WildBerries –∏ Ozon.

## üöÄ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- üì¶ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ä—Å–∏–Ω–≥** —Ç–æ–≤–∞—Ä–æ–≤ (–≤–∏–¥–µ–æ–∫–∞—Ä—Ç—ã, –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã, –º–∞—Ç–µ—Ä–∏–Ω—Å–∫–∏–µ –ø–ª–∞—Ç—ã, –∏–≥—Ä–æ–≤—ã–µ –∫–æ–Ω—Å–æ–ª–∏)
- üí∞ **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ü–µ–Ω** –∏ —Å–∫–∏–¥–æ–∫ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- üì∏ **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫—Ä–∞—Å–∏–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π** —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º —à–∞–±–ª–æ–Ω–æ–º
- üé® **–£–º–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –ø–æ—Å—Ç–∏–Ω–≥–∞** –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ —Å–∫–∏–¥–∫–∏
- üë§ **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–æ—Ç–æ–º
- üîí **–ü—Ä–∏–≤–∞—Ç–Ω—ã–π —Ä–µ–∂–∏–º** (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞)
- üîÑ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Product-Filter-Service** —á–µ—Ä–µ–∑ HTTP API

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
Bot (Telegram) ‚Üí Product-Filter-Service (HTTP API) ‚Üí WB-API + Ozon-API (gRPC)
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- **SchedulerService** - –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –ø–∞—Ä—Å–∏–Ω–≥–∞ –∏ –ø–æ—Å—Ç–∏–Ω–≥–∞
- **PostQueueService** - –û—á–µ—Ä–µ–¥—å –ø–æ—Å—Ç–æ–≤ —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏
- **TemplateImageGeneratorService** - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å —à–∞–±–ª–æ–Ω–æ–º
- **CategoryServices** - –°–µ—Ä–≤–∏—Å—ã –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
cd monorepo-root/bot
npm install
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:
```env
TELEGRAM_BOT_TOKEN=your_bot_token_here
TELEGRAM_CHAT_ID=your_chat_id_here
ADMIN_USER_ID=69884361
PRODUCT_FILTER_SERVICE_URL=http://localhost:3001
CHANNEL_URL=https://t.me/your_channel_username
```

### 3. –ó–∞–ø—É—Å–∫
```bash
# –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
npm run dev

# –ü—Ä–æ–¥–∞–∫—à–Ω —Ä–µ–∂–∏–º
npm run build
npm run start:prod
```

## üé® –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–∞—Å—Ç–æ–º–Ω—ã–π —à–∞–±–ª–æ–Ω –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫—Ä–∞—Å–∏–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ç–æ–≤–∞—Ä–æ–≤.

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —à–∞–±–ª–æ–Ω–∞:
1. –°–æ–∑–¥–∞–π—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ-—à–∞–±–ª–æ–Ω —Ä–∞–∑–º–µ—Ä–æ–º **1200x1200 –ø–∏–∫—Å–µ–ª–µ–π**
2. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–∞–∫ `template.png` –≤ –ø–∞–ø–∫–µ `media/`
3. –ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–∞—à —à–∞–±–ª–æ–Ω

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è:
- ‚úÖ –§–æ—Ç–æ —Ç–æ–≤–∞—Ä–∞ (–≤ —Ü–µ–Ω—Ç—Ä–µ —à–∞–±–ª–æ–Ω–∞)
- ‚úÖ –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
- ‚úÖ –°—Ç–∞—Ä–∞—è –∏ –Ω–æ–≤–∞—è —Ü–µ–Ω–∞
- ‚úÖ –ü—Ä–æ—Ü–µ–Ω—Ç —Å–∫–∏–¥–∫–∏
- ‚úÖ –¢–µ–≥–∏: "–•–û–†–û–®–ê–Ø –¶–ï–ù–ê" (5-10%), "–ú–ï–ì–ê –°–ö–ò–î–ö–ê" (>10%)
- ‚úÖ –ö–∞—Ç–µ–≥–æ—Ä–∏—è —Ç–æ–≤–∞—Ä–∞

## üìã –ö–æ–º–∞–Ω–¥—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

- `/start` - –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥ –∏ –ø–æ—Å—Ç–∏–Ω–≥
- `/stop` - –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞
- `/pause` - –ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ—Å—Ç–∏–Ω–≥
- `/resume` - –í–æ–∑–æ–±–Ω–æ–≤–∏—Ç—å –ø–æ—Å—Ç–∏–Ω–≥
- `/status` - –°—Ç–∞—Ç—É—Å –±–æ—Ç–∞
- `/clear` - –û—á–∏—Å—Ç–∏—Ç—å –æ—á–µ—Ä–µ–¥—å
- `/test` - –¢–µ—Å—Ç–æ–≤—ã–π –ø–∞—Ä—Å–∏–Ω–≥

## üîß –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Framework**: TypeScript + Node.js
- **Telegram API**: node-telegram-bot-api
- **HTTP Client**: node-fetch
- **Image Processing**: Sharp
- **Development**: nodemon, ts-node

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
src/
‚îú‚îÄ‚îÄ main.ts                           # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ register-commands.ts              # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥
‚îú‚îÄ‚îÄ register-services.ts              # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îî‚îÄ‚îÄ wb-api.client.ts             # HTTP –∫–ª–∏–µ–Ω—Ç –¥–ª—è Product-Filter-Service
‚îú‚îÄ‚îÄ commands/
‚îÇ   ‚îú‚îÄ‚îÄ admin.command.ts             # –ê–¥–º–∏–Ω –∫–æ–º–∞–Ω–¥—ã
‚îÇ   ‚îî‚îÄ‚îÄ dev.command.ts               # –ö–æ–º–∞–Ω–¥—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ base.service.ts              # –ë–∞–∑–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å
‚îÇ   ‚îú‚îÄ‚îÄ scheduler.service.ts         # –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫
‚îÇ   ‚îú‚îÄ‚îÄ post-queue.service.ts        # –û—á–µ—Ä–µ–¥—å –ø–æ—Å—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ template-image-generator-sharp.service.ts # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ videocards.service.ts        # –°–µ—Ä–≤–∏—Å –≤–∏–¥–µ–æ–∫–∞—Ä—Ç
‚îÇ   ‚îú‚îÄ‚îÄ processors.service.ts        # –°–µ—Ä–≤–∏—Å –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ motherboards.service.ts      # –°–µ—Ä–≤–∏—Å –º–∞—Ç–µ—Ä–∏–Ω—Å–∫–∏—Ö –ø–ª–∞—Ç
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îú‚îÄ‚îÄ dev.utils.ts                 # –£—Ç–∏–ª–∏—Ç—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ markdown.utils.ts            # –£—Ç–∏–ª–∏—Ç—ã —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
‚îî‚îÄ‚îÄ media/                           # –ú–µ–¥–∏–∞ —Ñ–∞–π–ª—ã –∏ —à–∞–±–ª–æ–Ω—ã
```

## üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Product-Filter-Service

–ë–æ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å Product-Filter-Service —á–µ—Ä–µ–∑ HTTP API:

```typescript
// –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ –∫ Product-Filter-Service
const response = await fetch(`${PRODUCT_FILTER_SERVICE_URL}/products/search`, {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    category: 'videocards',
    queries: ['rtx 5070', 'rtx 5080', 'rtx 5090']
  })
});
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ –æ—Ç–ª–∞–¥–∫–∏
npm run dev:debug

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
curl http://localhost:3001/health
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

- **–õ–æ–≥–∏**: –í—Å–µ –ª–æ–≥–∏ –ø–∏—à—É—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å
- **–°—Ç–∞—Ç—É—Å**: –ö–æ–º–∞–Ω–¥–∞ `/status` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- **–ú–µ—Ç—Ä–∏–∫–∏**: –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å—Ç–æ–≤, –æ—à–∏–±–∫–∏

## üö® –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `TELEGRAM_BOT_TOKEN` –≤ `.env`
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ Product-Filter-Service –∑–∞–ø—É—â–µ–Ω
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏

### –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Sharp: `npm install sharp`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ `media/template.png`
3. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –µ—Å—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å

### –ù–µ—Ç –Ω–æ–≤—ã—Ö –ø–æ—Å—Ç–æ–≤
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ø–∞—Ä—Å–∏–Ω–≥ –∑–∞–ø—É—â–µ–Ω: `/start`
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ Product-Filter-Service –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

---

**Telegram Bot** - —É–º–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ü–µ–Ω –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ –∫–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏–µ! üöÄ