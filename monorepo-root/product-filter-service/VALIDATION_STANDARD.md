# üéØ –°—Ç–∞–Ω–¥–∞—Ä—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ MarketVision

## üìã –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ç–æ—á–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ –∑–∞–ø—Ä–æ—Å–∞–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –ö–∞–∂–¥—ã–π –ø—Ä–æ–¥—É–∫—Ç –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–π—Ç–∏ **–í–°–ï** –ø—Ä–æ–≤–µ—Ä–∫–∏, —á—Ç–æ–±—ã –±—ã—Ç—å –ø—Ä–∏–∑–Ω–∞–Ω–Ω—ã–º –≤–∞–ª–∏–¥–Ω—ã–º.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å: `ProductValidatorBase`
```typescript
abstract class ProductValidatorBase {
  // –û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
  async validateBatch(products: any[], category: string): Promise<ValidationResult[]>
  
  // –ê–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π –º–µ—Ç–æ–¥ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π
  protected abstract customValidation(query: string, name: string, rules: ValidationRules): ValidationResult
  
  // –û–±—â–∏–µ –º–µ—Ç–æ–¥—ã
  protected normalizeForQuery(text: string): string
  protected isAccessory(name: string, accessoryWords: string[]): boolean
  protected extractModels(name: string, patterns: string[]): string[]
  
  // –£–ù–ò–í–ï–†–°–ê–õ–¨–ù–´–ô –º–µ—Ç–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–æ–¥–µ–ª–∏ - –¢–û–ß–ù–û–ï –°–û–í–ü–ê–î–ï–ù–ò–ï
  protected validateModelMatch(query: string, models: string[]): ValidationResult {
    const normQuery = this.normalizeForQuery(query);
    
    console.log(`[${this.constructor.name} MODEL MATCH] Query: "${query}" -> "${normQuery}"`);
    console.log(`[${this.constructor.name} MODEL MATCH] Models: [${models.join(', ')}]`);

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¢–û–õ–¨–ö–û —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
    if (models.includes(normQuery)) {
      console.log(`[${this.constructor.name} MODEL MATCH] ‚úÖ Exact match found: ${normQuery}`);
      return { isValid: true, reason: 'model-match', confidence: 0.95 };
    }

    console.log(`[${this.constructor.name} MODEL MATCH] ‚ùå No exact match found`);
    return { isValid: false, reason: 'no-model-match', confidence: 0.1 };
  }
  
  protected validateQueryInName(query: string, name: string): boolean
}
```

## üîÑ –ü—Ä–æ—Ü–µ—Å—Å –≤–∞–ª–∏–¥–∞—Ü–∏–∏

### –®–∞–≥ 1: –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è
```typescript
// –í—Ö–æ–¥: "PlayStation 5 Pro"
// –í—ã—Ö–æ–¥: "playstation5pro"
normalizeForQuery(text: string): string {
  return text.toLowerCase().replace(/\s+/g, '');
}
```

### –®–∞–≥ 2: –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
–ö–∞–∂–¥—ã–π –ø—Ä–æ–¥—É–∫—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç **–í–°–ï** –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ —Å—Ç—Ä–æ–≥–æ–º –ø–æ—Ä—è–¥–∫–µ:

1. **‚ùå –ê–∫—Å–µ—Å—Å—É–∞—Ä—ã** (–ë–õ–û–ö–ò–†–£–Æ–©–ê–Ø)
2. **‚ùå –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏** (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–ê–Ø)
3. **‚ùå –ó–∞–ø—Ä–æ—Å –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏** (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–ê–Ø)
4. **‚úÖ –í–∞–ª–∏–¥–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç**

## üìù –°—Ç–∞–Ω–¥–∞—Ä—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
```typescript
export class CategoryValidator extends ProductValidatorBase {
  // –£–ù–ò–í–ï–†–°–ê–õ–¨–ù–ê–Ø –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤ –±–∞–∑–æ–≤–æ–º –∫–ª–∞—Å—Å–µ:
  // 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Å–µ—Å—Å—É–∞—Ä–æ–≤ (–ë–õ–û–ö–ò–†–£–Æ–©–ê–Ø)
  // 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–¥–µ–ª–∏ (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–ê–Ø) 
  // 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏ (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–ê–Ø)
  
  // –¢–û–õ–¨–ö–û –∫–∞—Ç–µ–≥–æ—Ä–∏–π–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:
  protected categorySpecificValidation(query: string, name: string, rules: ValidationRules): ValidationResult {
    // –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã)
    // –ù–∞–ø—Ä–∏–º–µ—Ä: –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä–∏–∏ –≤–∏–¥–µ–æ–∫–∞—Ä—Ç, –≤–µ—Ä—Å–∏–∏ PlayStation, etc.
    
    // –í–°–ï –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã!
    console.log('‚úÖ ACCEPTED: all checks passed');
    return { isValid: true, reason: 'all-checks-passed', confidence: 0.95 };
  }
}
```

## üéÆ –ü—Ä–∏–º–µ—Ä—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏

### PlayStation 5 Pro
```typescript
// –ó–∞–ø—Ä–æ—Å: "playstation 5 pro"
// –ù–∞–∑–≤–∞–Ω–∏–µ: "PlayStation 5 Pro"

// –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è:
// Query: "playstation 5 pro" ‚Üí "playstation5pro"
// Name: "PlayStation 5 Pro" ‚Üí "playstation5pro"

// –ü—Ä–æ–≤–µ—Ä–∫–∏:
// 1. –ê–∫—Å–µ—Å—Å—É–∞—Ä? ‚ùå (–Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç accessoryWords)
// 2. –ú–æ–¥–µ–ª—å? ‚úÖ (–∏–∑–≤–ª–µ—á–µ–Ω–∞ "ps5pro", —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∑–∞–ø—Ä–æ—Å–æ–º)
// 3. –ó–∞–ø—Ä–æ—Å –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏? ‚úÖ (—Å–æ–¥–µ—Ä–∂–∏—Ç "playstation", "5", "pro")
// 4. –í–µ—Ä—Å–∏—è PlayStation? ‚úÖ (hasCorrectPlayStationVersion)

// –†–µ–∑—É–ª—å—Ç–∞—Ç: ‚úÖ –ü–†–ò–ù–Ø–¢
```

### PlayStation 5 Charging Station
```typescript
// –ó–∞–ø—Ä–æ—Å: "playstation 5"
// –ù–∞–∑–≤–∞–Ω–∏–µ: "PlayStation 5 DualSense Charging Station"

// –ü—Ä–æ–≤–µ—Ä–∫–∏:
// 1. –ê–∫—Å–µ—Å—Å—É–∞—Ä? ‚úÖ (—Å–æ–¥–µ—Ä–∂–∏—Ç "–∑–∞—Ä—è–¥–Ω–∞—è —Å—Ç–∞–Ω—Ü–∏—è")
// –†–µ–∑—É–ª—å—Ç–∞—Ç: ‚ùå –û–¢–ö–õ–û–ù–ï–ù (accessory)
```

## üîß –ü—Ä–∞–≤–∏–ª–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π

### PlayStation
```typescript
const PLAYSTATION_RULES: ValidationRules = {
  modelPatterns: [
    'ps\\d+',           // PS5, PS4, PS3
    'playstation\\s*\\d+', // PlayStation 5, PlayStation 4
    '\\d+',             // 5, 4, 3
  ],
  accessoryWords: [
    '–∑–∞—Ä—è–¥–Ω–∞—è —Å—Ç–∞–Ω—Ü–∏—è', '—Å—Ç–∞–Ω—Ü–∏—è –∑–∞—Ä—è–¥–∫–∏', '–∑–∞—Ä—è–¥–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ',
    '–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä', '–¥–∂–æ–π—Å—Ç–∏–∫', '–Ω–∞—É—à–Ω–∏–∫–∏', '–≥–∞—Ä–Ω–∏—Ç—É—Ä–∞',
    'portal', '–ø–æ—Ä—Ç–∞—Ç–∏–≤–Ω—ã–π', '–∞–∫—Å–µ—Å—Å—É–∞—Ä'
  ]
};
```

### –í–∏–¥–µ–æ–∫–∞—Ä—Ç—ã
```typescript
const VIDEOCARDS_RULES: ValidationRules = {
  modelPatterns: [
    'rtx\\s*\\d+\\d+\\d+', // RTX 4090, RTX 4080
    'gtx\\s*\\d+\\d+\\d+', // GTX 1660, GTX 1080
    'rx\\s*\\d+\\d+\\d+',  // RX 7900, RX 6800
  ],
  accessoryWords: [
    '–∫–∞–±–µ–ª—å', '–±–ª–æ–∫ –ø–∏—Ç–∞–Ω–∏—è', '–∫—É–ª–µ—Ä', '—Ä–∞–¥–∏–∞—Ç–æ—Ä',
    '—Ç–µ—Ä–º–æ–ø–∞—Å—Ç–∞', '–∞–∫—Å–µ—Å—Å—É–∞—Ä'
  ]
};
```

## ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

### 1. –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–æ–∫
- **–ù–ï** –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `cases.find()` - —ç—Ç–æ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –Ω–∞ –ø–µ—Ä–≤–æ–º —É—Å–ø–µ—Ö–µ
- **–ò–°–ü–û–õ–¨–ó–£–ô–¢–ï** –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ `if` –±–ª–æ–∫–∏
- –ü—Ä–æ–¥—É–∫—Ç –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–π—Ç–∏ **–í–°–ï** –ø—Ä–æ–≤–µ—Ä–∫–∏

### 2. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è
- **–í–°–ï–ì–î–ê** –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `normalizeForQuery()` –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏–π
- –£—á–∏—Ç—ã–≤–∞–π—Ç–µ, —á—Ç–æ –ø—Ä–æ–±–µ–ª—ã —É–¥–∞–ª—è—é—Ç—Å—è: "PlayStation 5" ‚Üí "playstation5"

### 3. –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤
- **validateModelMatch** - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ –≤ –±–∞–∑–æ–≤–æ–º –∫–ª–∞—Å—Å–µ
- **–ù–ï** –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–π—Ç–µ `validateModelMatch` –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö
- –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–π—Ç–µ —Ç–æ–ª—å–∫–æ `extractModels` –¥–ª—è —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ–π –ª–æ–≥–∏–∫–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è

### 4. –û—Ç–ª–∞–¥–∫–∞
- –î–æ–±–∞–≤–ª—è–π—Ç–µ `console.log` –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞
- –õ–æ–≥–∏—Ä—É–π—Ç–µ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏
- –£–∫–∞–∑—ã–≤–∞–π—Ç–µ –ø—Ä–∏—á–∏–Ω—É –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è

### 5. –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å (confidence)
- `0.9-1.0`: –í—ã—Å–æ–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å (–∞–∫—Å–µ—Å—Å—É–∞—Ä—ã, —è–≤–Ω—ã–µ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è)
- `0.7-0.8`: –°—Ä–µ–¥–Ω—è—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å (–Ω–µ—Ç –º–æ–¥–µ–ª–∏)
- `0.5-0.6`: –ù–∏–∑–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å (–∑–∞–ø—Ä–æ—Å –Ω–µ –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏)

## üöÄ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

1. **–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª:** `category-name.validator.ts`
2. **–ù–∞—Å–ª–µ–¥—É–π—Ç–µ—Å—å:** –æ—Ç `ProductValidatorBase`
3. **–†–µ–∞–ª–∏–∑—É–π—Ç–µ:** `customValidation()` —Å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏
4. **–î–æ–±–∞–≤—å—Ç–µ:** –≤ `ValidationFactoryService`
5. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ:** —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Å—Ü–µ–Ω–∞—Ä–∏—è–º–∏

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
```typescript
console.log(`[${this.constructor.name} DEBUG]`, {
  query, name, models,
  normalizedQuery: this.normalizeForQuery(query),
  normalizedName: this.normalizeForQuery(name)
});
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–Ω—è—Ç—ã—Ö/–æ—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤
- –ü—Ä–∏—á–∏–Ω—ã –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π
- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏

## üîç –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã
1. **–ü–æ–∑–∏—Ç–∏–≤–Ω—ã–µ —Å–ª—É—á–∞–∏:** –≤–∞–ª–∏–¥–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã
2. **–ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —Å–ª—É—á–∞–∏:** –∞–∫—Å–µ—Å—Å—É–∞—Ä—ã, –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è
3. **–ì—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏:** –ø–æ—Ö–æ–∂–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è
4. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –±–æ–ª—å—à–∏–µ –æ–±—ä–µ–º—ã –¥–∞–Ω–Ω—ã—Ö

### –ü—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–∞
```typescript
describe('PlayStation Validator', () => {
  it('should accept valid PS5 Pro', () => {
    const result = validator.customValidation(
      'playstation 5 pro',
      'PlayStation 5 Pro',
      PLAYSTATION_RULES
    );
    expect(result.isValid).toBe(true);
  });
  
  it('should reject PS5 accessory', () => {
    const result = validator.customValidation(
      'playstation 5',
      'PlayStation 5 Charging Station',
      PLAYSTATION_RULES
    );
    expect(result.isValid).toBe(false);
    expect(result.reason).toBe('accessory');
  });
});
```

---

**–í–∞–∂–Ω–æ:** –≠—Ç–æ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω—É—é –∏ –Ω–∞–¥–µ–∂–Ω—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –≤–æ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö MarketVision. –°–ª–µ–¥—É–π—Ç–µ –µ–º—É —Å—Ç—Ä–æ–≥–æ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ —Å–∏—Å—Ç–µ–º—ã. 